<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rootasrole [
	<!ELEMENT rootasrole (roles|options?)*>
	<!ATTLIST rootasrole version CDATA #REQUIRED>
	<!ELEMENT options (path?|env-keep?|env-check?|env-reset?|allow-root?|allow-bounding?|setuid?|wildcard-denied?)*>
	<!ELEMENT env-keep (#PCDATA|EMPTY)*>
	<!ELEMENT env-check (#PCDATA|EMPTY)*>
	<!ELEMENT allow-root EMPTY>
	<!ATTLIST allow-root enforce (true|false) "false">
	<!ELEMENT allow-bounding EMPTY>
	<!ATTLIST allow-bounding enforce (true|false) "false">
	<!ELEMENT wildcard-denied (#PCDATA|EMPTY)*>
	<!ELEMENT path (#PCDATA|EMPTY)*>
	<!ELEMENT roles (role*)>
	<!ELEMENT role (actors?|task*|options?)*>
	<!ATTLIST role
		name ID #REQUIRED
		priority CDATA "0">
	<!ELEMENT actors (user*|group*)>
	<!ELEMENT user EMPTY>
	<!ATTLIST user name CDATA #REQUIRED>
	<!ELEMENT group EMPTY>
	<!ATTLIST group names CDATA #REQUIRED>
	<!ELEMENT task (command*|options?|purpose?)*>
	<!ATTLIST task
		id ID #IMPLIED
		capabilities CDATA #IMPLIED
		setuser CDATA #IMPLIED
		setgroups CDATA #IMPLIED>
	<!ELEMENT command (#PCDATA)>
	<!ATTLIST command
		regex (true|false) "false">
	<!ELEMENT purpose (#PCDATA)>
]>
<rootasrole version="3.0.0-alpha.1">
	<!-- OPTIONS, could be applied to all roles, or to a specefic role, or to specific task in a
	role
		Be cautionous about changing them.-->
	<options>
		<!-- PATH configuration, you could replace, prepend or extend with paths.
			be warned about this option, you are responsible about misconfiguration 
			of this variable. Misconfiguration of roles with this variable could lead 
			to unexpected behaviors. We not recommend to use prepend or extend options.
			WARNING this could lead to critical attack vectors-->
		<path>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin</path>

		<!-- Environment variables to keep
			WARNING this could lead to critical attack vectors-->
		<env-keep>HOME,USER,LOGNAME,COLORS,DISPLAY,HOSTNAME,KRB5CCNAME,LS_COLORS,PS1,PS2,XAUTHORY,XAUTHORIZATION,XDG_CURRENT_DESKTOP</env-keep>

		<!-- Environment variables kept if safe (without % or / chars)
			WARNING, this could also lead to critical attack vectors-->
		<env-check>COLORTERM,LANG,LANGUAGE,LC_*,LINGUAS,TERM,TZ</env-check>

		<!-- By default, root is considered as unprivilegied user.
			With this option, root is considered as privileged super-user
			This option could break security features-->
		<allow-root enforce="false" />

		<!-- By default, capabilities are enforced and permanently removed 
			from the execution session, even for root. With this option,
			capabilities are not removed from the bounding set and it could be possible
			to elevate more privileges than specified in a session.
			This option could break security features-->
		<allow-bounding enforce="false" />

		<!-- By default any wildcard will avoid dang,erous characters that could start another
			command than specified-->
		<wildcard-denied>;&amp;|</wildcard-denied>
	</options>
	<roles>
		<role name="superuser">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="root" setuser="root" setgroups="root"> <!-- capabilities="" to define -->
				<command>**</command>
				<purpose>access to every commands</purpose>
			</task>
		</role>
		<role name="AdminIAM">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="root-as-role"> <!-- capabilities="" to define -->
				<command>/usr/sbin/rar (.*)</command>
				<purpose>Edit admin acess roles</purpose>
			</task>
		</role>
		<role name="IAM">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="account-management" setuser="root"> <!-- capabilities="" to define -->
				<purpose>Manage user accounts</purpose>
				<!--
				<command>/usr/bin/useradd (.*)</command>
				<command>/usr/bin/userdel (.*)</command>
				<command>/usr/bin/usermod (.*)</command>
				<command>/usr/bin/passwd (.*)</command>
				<command>/usr/bin/chage (.*)</command>
				<command>/usr/bin/chfn (.*)</command> -->
			</task>
			<task id="group-management" setuser="root"> <!-- capabilities="" to define -->
				<purpose>Manage user groups</purpose>
				<!--
				<command>/usr/bin/groupadd (.*)</command>
				<command>/usr/bin/groupdel (.*)</command>
				<command>/usr/bin/groupmod (.*)</command> -->
			</task>
		</role>
		<role name="backup">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="backup" setuser="root"> <!-- capabilities="" to define -->
				<purpose>Backup files</purpose>
				<!--
				<command>/usr/bin/rsync (.*)</command>
				<command>/usr/bin/tar (.*)</command>
				<command>/usr/bin/zip (.*)</command>
				<command>/usr/bin/unzip (.*)</command> -->
			</task>
		</role>
		<role name="network"> <!-- Not exaustive -->
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="ssh" ><!-- capabilities="" to define -->
				<purpose>Manage ssh</purpose>
				<!-- 
				<command>/usr/bin/ssh (.*)</command>
				<command>/usr/bin/ssh-keygen (.*)</command>
				<command>/usr/bin/ssh-copy-id (.*)</command>
				<command>/usr/bin/ssh-agent (.*)</command>
				<command>/usr/bin/ssh-add (.*)</command>
				<command>/usr/bin/ssh-keyscan (.*)</command>
				<command>/usr/bin/ssh-keysign (.*)</command>
				-->
			</task>
			<task id="ip" > <!-- capabilities="CAP_NET_RAW,CAP_NET_ADMIN"> -->
				<purpose>Manage connectivity</purpose>
				<!-- <command>/usr/bin/ip (.*)</command>
				<command>/usr/bin/ifconfig (.*)</command>
				<command>/usr/bin/arp (.*)</command>
				<command>/usr/bin/arping (.*)</command>
				<command>/usr/bin/ping (.*)</command>
				<command>/usr/bin/ping6 (.*)</command>
				<command>/usr/bin/traceroute (.*)</command>
				<command>/usr/bin/traceroute6 (.*)</command>
				<command>/usr/bin/route (.*)</command>
				<command>/usr/bin/netstat (.*)</command>
				<command>/usr/bin/ss (.*)</command>
				<command>/usr/bin/nc (.*)</command>
				<command>/usr/bin/ncat (.*)</command>
				<command>/usr/bin/nc.traditional (.*)</command>
				<command>/usr/bin/ncat-traditional (.*)</command> -->
			</task>
			<task id="dns">
				<purpose>Manage DNS</purpose>
				<!--
				<command>/usr/bin/dig (.*)</command>
				<command>/usr/bin/host (.*)</command>
				<command>/usr/bin/nslookup (.*)</command> -->
			</task>
		</role>
		<role name="installator">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="installator" setuser="root"> <!-- capabilities="" to define -->
				<purpose>Install software</purpose>
				<!--
				<command>/usr/bin/apt-get (.*)</command>
				<command>/usr/bin/aptitude (.*)</command>
				<command>/usr/bin/dpkg (.*)</command>
				<command>/usr/bin/dpkg-reconfigure (.*)</command>
				<command>/usr/bin/yum (.*)</command>
				<command>/usr/bin/rpm (.*)</command>
				<command>/usr/bin/pacman (.*)</command>
				-->
			</task>
		</role>
		<role name="monitoring" capabilities="CAP_AUDIT_READ,CAP_AUDIT_CONTROL">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="audit">
				<purpose>Manage audit</purpose>
				<!--
				<command>/usr/sbin/auditctl (.*)</command>
				<command>/usr/sbin/auditd (.*)</command>
				<command>/usr/sbin/aureport (.*)</command>
				<command>/usr/sbin/ausearch (.*)</command>
				<command>/usr/sbin/autrace (.*)</command>
				<command>/usr/sbin/aulast (.*)</command>
				<command>/usr/sbin/aulastlog (.*)</command>
				<command>/usr/sbin/auvirt (.*)</command>
				-->
			</task>
		</role>
		<role name="troubleshooting">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="troubleshooting" setuser="root"> <!-- capabilities="" to define -->
				<purpose>Manage troubleshooting</purpose>
				<!--
				<command>/usr/bin/strace (.*)</command>
				<command>/usr/bin/ltrace (.*)</command>
				<command>/usr/bin/ldd (.*)</command>
				<command>/usr/bin/ldconfig (.*)</command>
				-->
			</task>
		</role>
		<role name="forensic">
			<actors>
				<user name="ADMINISTRATOR" />
			</actors>
			<task id="all" setuser="root" setgroups="root"> <!-- capabilities="" to define -->
				<purpose>Break the glass case, forensic mode enabled</purpose>
				<!--<command>**</command>-->
			</task>
		</role>
	</roles>
</rootasrole>